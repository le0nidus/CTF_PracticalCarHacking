

bitstreams = ["0000001000000000010001110010101000010011100111001100101110100010001001100111001011011101", "0000001000000000010001110010101000000011100111000101101100010110010001100010111011010101", "0000001000000000010001110010101000010011101000001100111110001101110011110100011000010111", "0000001000000000010001110010101000000011101000000101011101001001111001111111101011001111", "0000001000000000010001110010101000010011101001001101011110101111100011100010011000001000", "0000001000000000010001110010101000000011101001000100111110101001100101100000101010110010", "0000001000000000010001110010101000010011101010000101011100011011101101001111111011010010", "0000001000000000010001110010101000000011101010001100111111010101001010001101111000101000", "0000001000000000010001110010101000010011101011000100111110111011101100011000111000011011", "0000001000000000010001110010101000000011101011001101011110111111101111110010011000110001", "0000001000000000010001110010101000010011101100001100110101101111001000000111001000111100", "0000001000000000010001110010101000000011101100000101011101111101100111100110111000000110"]
streams_filtered = []

def extract_data(istream):
    UID = int(istream[0:32], 2)
    btn = int(istream[32:36], 2)
    lctr = int(istream[36:46], 2)
    ks = int(istream[46:78], 2)
    ks_inverted = ks ^ 0xffffffff
    excess_2bits = int(istream[78:80], 2)
    chk = int(istream[80:], 2)
    CNTR_H = "000000000000000000"
    nR = CNTR_H + istream[36:46] + istream[32:36]
    nR = int(nR, 2)
    return {
        'UID': UID,
        'btn' : btn,
        'lctr' : lctr,
        'ks' : ks,
        'ks_inverted' : ks_inverted,
        'excess_2bits' : excess_2bits,
        'chk' : chk,
        'nR' : nR
    }


for idx, stream in enumerate(bitstreams):
    streams_filtered.append(extract_data(stream))
    print("\nidx = ", idx)
    print("UID = 0x%08X" % streams_filtered[idx]['UID'])
    print("nR = 0x%08X" % streams_filtered[idx]['nR'])
    print("ks = 0x%08X" % streams_filtered[idx]['ks'])
    print("ks inverted = 0x%08X" % (streams_filtered[idx]['ks_inverted']))


print("\n\n./ht2crack5 0x%08X 0x%08X 0x%08X 0x%08X 0x%08X" % (streams_filtered[0]['UID'], streams_filtered[10]['nR'], streams_filtered[10]['ks_inverted'], streams_filtered[0]['nR'], streams_filtered[0]['ks_inverted']))